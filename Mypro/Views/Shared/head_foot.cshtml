<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Index - Welcome Ajay Fashion</title>
    <meta name="description" content="">
    <meta name="keywords" content="">

    <!-- Favicons -->
    <link href="~/template/assets/img/favicon.png" rel="icon">
    <link href="~/template/assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Inter:wght@400;700&family=Amatic+SC:wght@700&display=swap" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="~/template/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="~/template/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="~/template/assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="~/template/assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="~/template/assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="~/template/assets/css/main.css" rel="stylesheet">
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true" />


</head>

<body class="index-page">

    <header id="header" class="header d-flex align-items-center sticky-top">
        <div class="container position-relative d-flex align-items-center justify-content-between">

            <a href="" class="logo d-flex align-items-center me-auto me-xl-0">
                <!-- Logo Image -->
                <img src="~/template/assets/img/mylogo.png" alt="FashionRack Logo" class="logo-img">

                <!-- Stylish Text -->
                <h1> <span class="logo-text">FashionRack.</span></h1>
            </a>

            @* <style>
                /* Make logo 30% bigger */
                .logo-img {
                    transform: scale(1.9); /* 30% bigger */
                    height: auto;
                    margin-right: 10px;
                    transition: transform 0.3s ease; /* Optional smooth effect */
                }

                /* Stylish text matching logo colors */
                .logo-text {
                    font-family: 'Brush Script MT', cursive;
                    font-size: 2rem;
                    font-weight: bold;
                    background: linear-gradient(45deg, #f7941d, #ec008c);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    display: inline-block;
                }

                .logo {
                    justify-content: flex-start;
                }
            </style> *@

            <div class="right-section">
            <!-- Hamburger -->
         

            <nav id="navmenu" class="navmenu">
                <ul>
                    <li><a href="#hero" class="active nav-link-gradient">Home</a></li>
                    <li><a href="#about" class="nav-link-gradient">About</a></li>
                    <li><a href="#menu" class="nav-link-gradient">Menu</a></li>
                    <li><a href="#testimonials" class="nav-link-gradient">Testimonials</a></li>
                    <li><a href="#owner" class="nav-link-gradient">Owner</a></li>
                    <li><a href="#gallery" class="nav-link-gradient">Gallery</a></li>
                    <li><a href="#contact" class="nav-link-gradient">Contact</a></li>
                </ul>
                <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
            </nav>
            </div>

            <style>
                .navmenu ul {
                    display: flex;
                    align-items: center;
                    gap: 0;
                    margin: 0;
                    padding: 0;
                    list-style: none;
                    justify-content: center;
                }

                    .navmenu ul li {
                        margin: 0;
                        padding: 0;
                    }

                        .navmenu ul li a {
                            font-weight: bold;
                            font-size: 1rem;
                            text-decoration: none;
                            background: linear-gradient(45deg, #f7941d, #ec008c);
                            -webkit-background-clip: text;
                            -webkit-text-fill-color: transparent;
                            transition: 0.3s;
                            padding: 0 8px;
                        }

                            .navmenu ul li a:hover {
                                background: linear-gradient(45deg, #ec008c, #f7941d);
                                -webkit-background-clip: text;
                                -webkit-text-fill-color: transparent;
                            }

            </style>







            @* @if (User.Identity.IsAuthenticated)
            {
                <div class="d-flex align-items-center">
                    <span class="me-3">Welcome, @User.Identity.Name!</span>
                    <a class="btn btn-sm btn-primary me-2" asp-controller="User" asp-action="EditProfile">Profile</a>
                    <form method="post" asp-controller="Account" asp-action="Logout" style="display:inline;">
                        <button type="submit" class="btn btn-sm btn-danger">Logout</button>
                    </form>
                </div>
            }
            else
            {
                <a class="btn-getstarted" asp-controller="Account" asp-action="Login">Login / Register</a>
            } *@

            @if (User.Identity.IsAuthenticated)
            {
                var db = Context.RequestServices.GetService<ApplicationDbContext>();
                var email = User.FindFirst(System.Security.Claims.ClaimTypes.Email)?.Value;
                var customer = db.Customers.FirstOrDefault(c => c.Email == email);

                
                <div class="d-flex align-items-center ms-auto">

                    @if (!string.IsNullOrEmpty(customer?.PhotoPath))
                    {
                        <img src="~/uploads/@customer.PhotoPath"
                             class="rounded-circle"
                             style="width:35px; height:35px; object-fit:cover;" />
                    }
                    else
                    {
                        <div class="rounded-circle bg-primary text-white d-flex justify-content-center align-items-center"
                             style="width:35px; height:35px; font-weight:bold;">
                            @User.Identity.Name.Substring(0, 1).ToUpper()
                        </div>
                    }

                    <br />
                    <div class="d-flex align-items-center">
                        <span class="me-3">Welcome, @User.Identity.Name!</span>
                        <a class="btn btn-sm btn-primary me-2" asp-controller="User" asp-action="EditProfile">Profile</a>
                        <form method="post" asp-controller="Account" asp-action="Logout" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-danger me-2">Logout</button>
                        </form>

                        <!-- Wishlist Icon -->
                        <a href="/Account/Wishlist" class="text-dark me-2" title="Add to Whistlist" style="font-size: 1.3rem;">
                            <i class="bi bi-heart"></i>
                        </a>

                        <!-- Cart Icon -->
                        <a href="@Url.Action("Cart", "Account")" class="text-dark me-2" title="Add to Cart" style="font-size:1.3rem;">
                            <i class="bi bi-cart"></i>
                        </a>
                       
                        <!-- Notification Bell -->


                        <a href="#" id="notificationBell" class="nav-link position-relative" title="Notification" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-bell fs-5"></i>
                                <span id="notificationBadge"
                                      class="badge bg-danger rounded-circle position-absolute"
                                      style="top:-6px; right:-6px; font-size:0.65rem; display:none; min-width:18px; height:18px; padding:2px;">0</span>
                            </a>

                            <ul class="dropdown-menu dropdown-menu-end shadow p-0 border-0"
                                style="width:360px; max-height:460px; overflow-y:auto; border-radius:10px;" id="notificationDropdown">

                                <li class="dropdown-header d-flex justify-content-between align-items-center bg-light py-2 px-3 border-bottom">
                                    <span class="fw-bold">Notifications</span>
                                    @* <button class="btn btn-sm btn-link text-decoration-none p-0" id="markAllRead" style="font-size:0.8rem;">Mark all read</button> *@
                                </li>

                                <ul id="notificationContainer" class="list-unstyled m-0 p-0">
                                    <li class="text-center text-muted py-3">Loading...</li>
                                </ul>
                            </ul>
                        

                    

                   

                        @* <!--Order -->
                        @{
                            var orderConfirmedId = TempData.Peek("OrderConfirmedId") as int?;
                        }

                        @if (orderConfirmedId.HasValue)
                        {
                            <a href="@Url.Action("OrderConfirmation", "Order", new { id = orderConfirmedId.Value })"
                               class="text-success me-2"
                               title="View Your Order Details"
                               style="font-size:1.3rem; position: relative;">
                                <i class="bi bi-check-circle-fill"></i>
                                <span style="position:absolute; top:-5px; right:-5px; font-size:0.7rem; color:white; background:red; border-radius:50%; padding:1px 4px;">New</span>
                            </a>
                        } *@


                    </div>
                </div>
            }
            else
            {
                <a class="btn-getstarted" asp-controller="Account" asp-action="Login">Login / Register</a>
            }

            <div class="hamburger"><i class="bi bi-list"></i></div>

        </div>
    </header>

    @RenderBody()

    <footer id="footer" class="footer dark-background">
        <div class="container">
            <div class="row gy-3">
                <div class="col-lg-3 col-md-6 d-flex">
                    <i class="bi bi-geo-alt icon"></i>
                    <div class="address">
                        <h4>Address</h4>
                        <p>2/25 Ajay Fashion Gujarat Housing Board, Bombay Market, Umarwada, Surat</p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6 d-flex">
                    <i class="bi bi-telephone icon"></i>
                    <div>
                        <h4>Contact</h4>
                        <p>
                            <strong>Phone:</strong> 9898308449<br>
                            <strong>Email:</strong> kirit749@gmail.com
                        </p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6 d-flex">
                    <i class="bi bi-clock icon"></i>
                    <div>
                        <h4>Opening Hours</h4>
                        <p>
                            <strong>Mon-Sat:</strong> 9AM - 8PM<br>
                            <strong>Sunday:</strong> 9AM - 1PM
                        </p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6">
                    <h4>Follow Us</h4>
                    <div class="social-links d-flex">
                        <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>

        <div class="container copyright text-center mt-4">
            <p>© <strong class="px-1 sitename">Ajay Fashion</strong> All Rights Reserved</p>
        </div>
    </footer>

    <!-- Scroll Top -->
    <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

    <!-- Preloader -->
    <div id="preloader"></div>

    <!-- Vendor JS Files -->
    <script src="~/template/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="~/template/assets/vendor/php-email-form/validate.js"></script>
    <script src="~/template/assets/vendor/aos/aos.js"></script>
    <script src="~/template/assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="~/template/assets/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="~/template/assets/vendor/swiper/swiper-bundle.min.js"></script>

    <!-- Main JS File -->
    <script src="~/template/assets/js/main.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const hamburger = document.querySelector(".hamburger");
            const navmenu = document.querySelector(".navmenu");

            // Toggle menu on hamburger click
            hamburger.addEventListener("click", function (e) {
                e.stopPropagation(); // Prevent the click from propagating to document
                navmenu.classList.toggle("active");
            });

            // Close menu if clicking outside
            document.addEventListener("click", function (e) {
                if (!navmenu.contains(e.target) && !hamburger.contains(e.target)) {
                    navmenu.classList.remove("active");
                }
            });

            // Optional: close menu when a nav link is clicked (for mobile)
            navmenu.querySelectorAll("a").forEach(link => {
                link.addEventListener("click", () => {
                    navmenu.classList.remove("active");
                });
            });
        });


        $(document).ready(function () {
            loadNotifications();
            setInterval(loadNotifications, 30000); 

            // Load notifications
            function loadNotifications() {
                $.ajax({
                    url: '/api/notifications/unread-count',
                    method: 'GET',
                    success: function (data) {
                        updateNotificationBadge(data.count);
                    }
                });

                $.ajax({
                    url: '/api/notifications/recent',
                    method: 'GET',
                    success: function (data) {
                        displayNotifications(data);
                    }
                });
            }

            // Update bell badge
            function updateNotificationBadge(count) {
                const badge = $('#notificationBadge');
                if (count > 0) {
                    badge.text(count > 99 ? '99+' : count);
                    badge.show();
                } else {
                    badge.hide();
                }
            }

            // Display notifications
            function displayNotifications(notifications) {
                const container = $('#notificationContainer');
                container.empty();

                if (!notifications || notifications.length === 0) {
                    container.html('<li class="text-center text-muted py-3">No new notifications</li>');
                    return;
                }

                notifications.forEach(function (notif) {
                    const item = `
                        <li class="border-bottom py-2 px-3 d-flex align-items-start hover-bg-light"
                            data-id="${notif.notificationId}" style="cursor:pointer;">
                            ${notif.imagePath ? `
                                <img src="${notif.imagePath}" class="rounded me-2"
                                     style="width:48px; height:48px; object-fit:cover;">
                            ` : `<i class="bi bi-image text-secondary fs-3 me-2"></i>`}
                            <div class="flex-grow-1">
                                <div class="fw-semibold">${notif.title}</div>
                                <div class="text-muted small">${notif.message}</div>
                                <div class="text-muted" style="font-size:0.8rem;">${notif.timeAgo}</div>
                            </div>
                            <button class="btn btn-sm btn-link text-muted mark-read-btn p-0" data-id="${notif.notificationId}">
                                <i class="bi bi-x-lg"></i>
                            </button>
                        </li>`;
                    container.append(item);
                });
            }

            // Mark all as read
            $('#markAllRead').on('click', function () {
                $.ajax({
                    url: '/api/notifications/mark-all-read',
                    method: 'POST',
                    success: function () {
                        loadNotifications();
                    }
                });
            });

            // Mark single as read
            $(document).on('click', '.mark-read-btn', function (e) {
                e.stopPropagation();
                const id = $(this).data('id');
                $.ajax({
                    url: `/api/notifications/mark-read/${id}`,
                    method: 'POST',
                    success: function () {
                        loadNotifications();
                    }
                });
            });

            // Hover effect
            const style = document.createElement('style');
            style.textContent = `.hover-bg-light:hover { background-color: #f8f9fa; }`;
            document.head.appendChild(style);
        });
   



    </script>
    

    @RenderSection("Scripts", required: false)
</body>

</html>
